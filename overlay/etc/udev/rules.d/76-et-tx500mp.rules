# Author   : Gaston Gonzalez
# Date     : 1 September 2025
# Updated  : 2 September 2025
# Purpose  : udev rules for the TX-500MP
#
# Preconditions:
# 1. Lab599 TX-500MP (DigiRig Lite) is selected via et-radio
# 2. Lan599 TX-500MP is connected via USB-A cable
#
# Postconditions:
# 1. /dev/et-cat created
# 2. /dev/et-audio created
# 3. rigctld is started
# 
KERNEL=="ttyUSB[0-9]*", SUBSYSTEM=="tty", PROGRAM="/opt/emcomm-tools/sbin/udev-tester.sh lab599-tx500mp", \
    ENV{ET_DEVICE}="TX-500MP"

# CAT control device will only match if PROGRAM above matches (exit status=0)
SUBSYSTEM=="tty", ENV{ET_DEVICE}=="TX-500MP", \
    ATTRS{idVendor}=="0403", ATTRS{idProduct}=="6001",\
    ACTION=="add", \
    ENV{ET_SUBDEVICE}="CAT", GROUP="dialout", MODE="0660", SYMLINK+="et-cat", \
    RUN+="/usr/bin/systemctl start rigctld"

# Audio device will only match if PROGRAM above matches (exit status=0)
#SUBSYSTEM=="sound", ATTRS{idVendor}=="0d8c", ATTRS{idProduct}=="0016", \
#    PROGRAM="/opt/emcomm-tools/sbin/udev-tester.sh yaesu-ftx1", \
#    ACTION=="add", \
#    ENV{ET_DEVICE}="FTX-1", \
#    ATTR{id}="ET_AUDIO", \
#    ENV{ET_SUBDEVICE}="AUDIO", GROUP="audio", MODE="0660", SYMLINK+="et-audio"
